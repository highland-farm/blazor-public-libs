@page "/"

<p>
    <button @onclick="ToggleStarted">@(Started ? "Stop Video" : "Start Video")</button>
    <button @onclick="ToggleVisibility">@(Visible ? "Hide Video" : "Show Video")</button>
    <button @onclick="ScanCodeAsync" disabled="@Scanning">Scan Code</button>
    <span>@Status</span>
</p>
<div
      style="
        width: 800px;
        min-height: 100px;
        resize: both;
        overflow: hidden;
        border: 3px solid black;
        background-color: gray;
      "
    >
    <ScannerViewport @ref="Viewport" Started="@Started" Visible="@Visible" />
</div>

@code {
    private bool Started = false;
    private bool Visible = true;
    private void ToggleStarted() => Started ^= true;
    private void ToggleVisibility() => Visible ^= true;
    private bool Scanning = false;

    private ScannerViewport Viewport;
    private string Status = "No scan yet.";

    private async Task ScanCodeAsync()
    {
        Status = "Scanning...";
        Scanning = true;

        try
        {
            Status = await Viewport.ScanCodeAsync();
        }
        catch (JSException ex)
        {
            Status = ex.Message;
        }
        finally
        {
            Scanning = false;
        }
    }
}
